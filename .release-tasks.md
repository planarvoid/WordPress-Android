# Release checklist

**Beta due date:** __
**Prod due date:** __

**Current beta version:** __
**Current prod version:** __
**Current rollout:** 0%

**Feature flags going live**

- ...
- ...

**Progress**

- [ ] check feature flags for things that need to go live (sync with team)
- [ ] deploy api-mobile to beta proc
- [ ] canary api-mobile production instance
- [ ] make sure [master build](http://ci.mobile.s-cloud.net:8080/view/android/job/soundcloud_android_integration_tests/) is green
- [ ] merge master into release
- [ ] make sure [release build](http://ci.mobile.s-cloud.net:8080/view/android/job/soundcloud_android_release/) is green
- [ ] promote the release build ("build beta")
- [ ] make sure regression test templates are up to date
- [ ] email APK from promoted beta build to team/testers and do a regression test
- [ ] schedule a TestDroid run and check the results on the dashboard
- [ ] deploy tested beta build to beta channel
- [ ] slog the beta release
- [ ] check graphs for [api-mobile-beta](http://promdash.int.s-cloud.net/api-mobile-beta)
- [ ] check issues in [Crashlytics (beta)](https://www.crashlytics.com/soundcloudandroid/android/apps/com.soundcloud.android)
- [ ] check numbers in [Localytics (beta)](https://dashboard.localytics.com/interact?org_id=127#/?app_id=8fecc6a72fcb74ddc76e2ac-02fa3b92-08f2-11e3-120d-004a77f8b47f)
- [ ] fix issues that come up
- [ ] make sure api-mobile is fully deployed
- [ ] promote release build to 1% in production
- [ ] slog the 1% release
- [ ] check graphs for [api-mobile](http://promdash.int.s-cloud.net/api-mobile)
- [ ] check issues in [Crashlytics (prod)](https://www.crashlytics.com/soundcloudandroid/android/apps/com.soundcloud.android)
- [ ] check issues in [Play Store](https://play.google.com/apps/publish/?dev_acc=04754990293619832077#ErrorClusterListPlace:p=com.soundcloud.android&lr=LAST_24_HRS)
- [ ] check numbers in [Localytics (prod)](https://dashboard.localytics.com/interact?org_id=127#/?app_id=182e977569f7648ada7d3b0-7806ed4c-0a4a-11e3-8dbf-005cf8cbabd8)
- [ ] check graphs for [Ad impressions](http://promdash.int.s-cloud.net/ads-on-android)
- [ ] fix issues that come up
- [ ] make sure Play Store update notes are available
- [ ] roll out to 100%
- [ ] slog the 100% release
- [ ] inform all interested parties about the release (TBD)
- [ ] remove feature flags for code that was shipped
- [ ] merge release branch to master
- [ ] hand over to next release captain

**Tips**

- to grep API logs for status code, you can do e.g. this:
  `bazooka -a api-mobile-staging log beta | grep -v health | egrep " \d{3} \w+[^(]"`
- to monitor a canaried instance, you can create ad-hoc [Prometheus graphs](http://prometheus-api-mobile:9090/graph) from expressions (`XXX` is the canary instance:)
  - response code trend: `SUM(rate(apimobile_incoming_http_request_count{instance =~ "http://ams-appXXX."}[1m])) BY (statusClass)`
  - 5xx break down: `SUM(rate(apimobile_incoming_http_request_count{statusClass = "5xx", instance =~ "http://ams-appXXX."}[5m])) BY (path)`
